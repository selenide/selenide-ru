---
layout: post
title: "Вышла Selenide 6.8.0"
description: ""
category:
header-text: "Мы тебя найдём даже в shadow dom"
tags: []
---
{% include JB/setup %}

<br>
# Недоброе утро!

Пока в мире творится здипец, мы выпускаем релиз [Selenide 6.8.0](https://github.com/selenide/selenide/milestone/161?closed=1).  
Фич немного, больше обновление зависимостей. 

* [Рекурсивный поиск по shadow dom](#deep-shadow-selectors)
* [Метод page без параметров](#add-page-without-class)
* [Аннотация @As](#as-annotation)
* [Новости](#news)
{: .blogpost-menu}

### Рекурсивный поиск по shadow dom {#deep-shadow-selectors}

Как вы знаете, в селениде [есть возможность](/2020/03/18/selenide-5.10.0) искать элементы внутри shadow dow. 
И даже в нескольких вложенных shadow dom:

```java
$(shadowCss("#reportButton", 
     "#shadow-host", "#inner-shadow-host")).click();
```

Хорошо, что это возможно, но это по-прежнему требует ваших временных затрат на то, чтобы изучить dom и найти точные
локаторы для всех этих теневых элементов. 

Теперь вы сможете сэкономить время с помощью нового метода `shadowDeepCss` - он ищет элемент во всех shadow root по всему dom. 

```java
$(shadowDeepCss("#reportButton")).click();
```

Естественно, остаётся риск, что такой "слишком широкий" поиск может найти и не тот элемент, если в ваших теневых областях есть 
несколько элементов в искомым локатором. В этом случае придётся вернуться к более точечному поиску. 

> Как и в случае с базами данных и сосисками, "внутрь лучше не заглядывать" - там начинка из мудрёного джаваскрипта для поиска по дереву.

См. [issue 1946](https://github.com/selenide/selenide/issues/1946).

Спасибо 
1. [Boris Osipov](https://github.com/BorisOsipov) за [PR 1947](https://github.com/selenide/selenide/pull/1947), а также
2. [Georgegriff](https://github.com/Georgegriff) за проект [query-selector-shadow-dom](https://github.com/Georgegriff/query-selector-shadow-dom), откуда мы этот код и спёрли.

<br>


### Добавили метод `page()`, не требующий `Class` {#add-page-without-class}

Дорогие фанаты пэдж обжектов, садитесь поудобнее, это для вас. В вашей жизни наступает переломный момент.

Теперь в метод `page(Class pageObjectClass)` больше не нужно передавать параметр `Class`. Да-да!
Вместо 
```java
SelectsPage page = page(SelectsPage.class);
```

вы сможете писать просто 
```java
SelectsPage page = page();
```

Раньше я думал, что Java так не умеет, но потом нашёл [хак](https://twitter.com/tagir_valeev/status/1262763570904719361).

См. [PR 1961](https://github.com/selenide/selenide/pull/1961) и
спасибо [Тагиру Валееву](https://twitter.com/tagir_valeev) за хак. 

<br>

### Добавили аннотацию `@As` {#as-annotation}
... для задания алиасов полям пэдж обжекта.

#### 1. Без алиасов
Если у вас есть пэдж обжект с аннотациями типа `@FindBy`:
```java
class PageObject {
  @FindBy(xpath="//table/div[3]/span[4]/h1")
  SelenideElement header;
}
```
И тест типа `page.header.shouldBe(visible)`,

То в отчётах он выглядит громоздко и непонятно:
```text
| open                                  | https://devclub.eu  | PASS  |
| By.xpath: //table/div[3]/span[4]/h1   | should be(visible)  | FAIL  |
```

А если тест упадёт, то в сообщении не очень-то понятно, о каком элементе идёт речь:
```java
Element not found {By.xpath: //table/div[3]/span[4]/h1}
```

Люди часто хотят дать какое-то человеческое название этому элементу, чтобы не видеть в отчётах длинный непонятный xpath.

#### 2. Сопротивление
Я всегда был против этого. 
Я считаю, что не только отчёты, но и сами тесты должны быть читабельными. Я за чистый код. 
Не нравится уродливый xpath - ну так измени его, а не прячь!


Но потом я решил дать заднюю.
> Ведь если мы не дадим заднюю, то они могут дать заднюю, а вот если мы её дадим, они её не дадут.
Заднюю никто не даст больше, кроме нас.

Убедительно же! Поэтому в версии [Selenide 5.17.0](/2020/12/26/selenide-5.17.0/) мы добавили метод `$.as("alias")`. 

#### 3. С алиасами

А с этого релиза - ещё и можете навесить аннотацию `@As` на поля поля пэджобжектов. 

```java
class PageObject {
  @As("Large header")
  @FindBy(tagName = "h1")
  SelenideElement header1;
}
```

В отчётах он будет выглядеть короче:
```text
| open    | https://devclub.eu   | PASS   |
| title   | should be(visible)   | FAIL   |
```

А при падении теста будет легче понять, о каком элементе речь:
```java
Element "title" not found {By.xpath: //table/div[3]/span[4]/h1}
```
См. [issue 1903](https://github.com/selenide/selenide/issues/1903) и [PR 1956](https://github.com/selenide/selenide/pull/1956).

<br>


### Обновили зависимости {#update-dependencies}

> Объявлена частичная мобилизация зависимостей!

* BrowserUpProxy from 2.2.2 to 2.2.3
* LittleProxy from 2.0.11 to 2.0.12
* Netty from 4.1.80.Final to 4.1.82.Final
* slf4j from 2.0.0 to 2.0.2
* JUnit from 5.9.0 to 5.9.1  --  см. [release notes](https://junit.org/junit5/docs/5.9.1/release-notes/)

<br>

### Новости {#news}

* Продолжается серия от Dilpreet Johal - теперь [Upload file with Selenide](https://dev.to/automationbro/upload-file-with-selenide-1f2a)
* [Alchemy or Translating JIRA with Selenide](https://sdet-tomaszbuga.medium.com/test-automation-framework-selenium-with-java-alchemy-or-translating-jira-with-selenide-with-e8831ebfe337) от Tomasz Buga
* Вышла Java 19. 


### Статистика {#statistics}

Свежая статистика скачиваний Селенида нас только радует. Перевалили за 400 тыщ!

<center>
  <img src="{{ BASE_PATH }}/images/2022/09/selenide.downloads.png" width="800"/>
</center>

<br>

Смотрите [Масяню!](https://www.youtube.com/watch?v=m6TwkNAmI3A&ab_channel=MasyanyaKuvaeva) 

<br>

[Андрей Солнцев](http://asolntsev.github.io/)

ru.selenide.org
